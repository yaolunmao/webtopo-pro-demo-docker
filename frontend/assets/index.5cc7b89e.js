import{_ as le,B as oe,u as ae,r as u,C as ne,N as re,a2 as se,e as r,o as V,c as q,F as D,G as F,g as o,f as t,w as a,j as ue,n as _,l as f,D as I,O as ce,P as de,k as ie,z as pe,t as me}from"./index.656e8806.js";import{l as _e,g as fe,u as ve,a as ge,d as ye}from"./project.8b468368.js";import{b as he}from"./device.27fe1467.js";const je={class:"app-container"},be={class:"toolbar"},ke={class:"card-header"},xe=["onClick"],we=["src"],Ce={style:{display:"flex","margin-top":"10px","justify-content":"flex-end"}},Ne={class:"dialog-footer"},Ve=oe({name:"Project"}),Ie=Object.assign(Ve,{setup(Pe){const P=ae(),{proxy:p}=me(),S=u([]),i=u(!1),R=u(!0),h=u(!0),j=u([]);u(!0),u(!0);const b=u(0),k=u(""),U=u([]),v=u([]),L=ne({form:{},queryParams:{pageNum:1,pageSize:10,projectName:null},rules:{}}),{queryParams:c,form:s,rules:z}=re(L);function m(){R.value=!0,_e(c.value).then(n=>{S.value=n.rows,b.value=n.total,R.value=!1})}function E(){i.value=!1,x()}function x(){s.value={projectId:null,projectName:null,thumbnail:null,dataModel:null,createBy:null,createTime:null,updateBy:null,updateTime:null,remark:null},p.resetForm("projectRef"),v.value=[]}function w(){c.value.pageNum=1,m()}function T(){p.resetForm("queryRef"),w()}function K(){x(),i.value=!0,k.value="\u6DFB\u52A0\u9879\u76EE"}function Q(n){const e=n.projectId||j.value;P.push({name:"WebtopoEdit",query:{project_id:e}})}function A(n){const e=n.projectId||j.value;window.open(P.resolve({path:"/webtopoPreview",query:{project_id:e}}).href)}function M(n){console.log(n,175),x();const e=n.projectId||j.value;fe(e).then(g=>{s.value=g.data,v.value=g.data.deviceList.filter(d=>d.projectId==n.projectId).map(d=>d.deviceId),i.value=!0,k.value="\u4FEE\u6539\u9879\u76EE"})}function O(){p.$refs.projectRef.validate(n=>{n&&(s.value.deviceList=v.value.map(e=>({projectId:s.value.projectId,deviceId:e})),s.value.projectId!=null?ve(s.value).then(e=>{p.$modal.msgSuccess("\u4FEE\u6539\u6210\u529F"),i.value=!1,m()}):ge(s.value).then(e=>{p.$modal.msgSuccess("\u65B0\u589E\u6210\u529F"),i.value=!1,m()}))})}function G(n){const e=n.projectId||j.value;p.$modal.confirm('\u662F\u5426\u786E\u8BA4\u5220\u9664"'+n.projectName+'"\u7684\u6570\u636E\u9879\uFF1F').then(function(){return ye(e)}).then(()=>{m(),p.$modal.msgSuccess("\u5220\u9664\u6210\u529F")}).catch(()=>{})}return m(),he().then(n=>{if(console.log(n,224),n.code!=200){se.error(n.msg);return}U.value=n.rows.map(e=>({...e,label:e.name,value:e.id}))}),(n,e)=>{const g=r("el-input"),d=r("el-form-item"),y=r("el-button"),$=r("el-form"),W=r("el-tooltip"),H=r("right-toolbar"),B=r("el-row"),C=r("el-link"),J=r("el-card"),X=r("el-col"),Y=r("pagination"),Z=r("el-select-v2"),ee=r("el-dialog");return V(),q("div",je,[D(t($,{model:o(c),ref:"queryRef",inline:!0,"label-width":"68px"},{default:a(()=>[t(d,{label:"\u9879\u76EE\u540D\u79F0",prop:"projectName"},{default:a(()=>[t(g,{modelValue:o(c).projectName,"onUpdate:modelValue":e[0]||(e[0]=l=>o(c).projectName=l),placeholder:"\u8BF7\u8F93\u5165\u9879\u76EE\u540D\u79F0",clearable:"",onKeyup:ue(w,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),t(d,null,{default:a(()=>[t(y,{type:"primary",icon:"Search",onClick:w},{default:a(()=>[_("\u641C\u7D22")]),_:1}),t(y,{icon:"Refresh",onClick:T},{default:a(()=>[_("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1},8,["model"]),[[F,o(h)]]),t(B,{gutter:10,class:"mb8"},{default:a(()=>[f("div",be,[t(W,{effect:"dark",content:"\u65B0\u589E",placement:"top"},{default:a(()=>[t(y,{plain:"",circle:"",icon:"Plus",onClick:K,style:{"margin-right":"10px"}})]),_:1}),t(H,{showSearch:o(h),"onUpdate:showSearch":e[1]||(e[1]=l=>I(h)?h.value=l:null),onQueryTable:m},null,8,["showSearch"])])]),_:1}),t(B,null,{default:a(()=>[(V(!0),q(ce,null,de(o(S),(l,te)=>(V(),ie(X,{key:l.projectId,span:4,offset:te%5!==0?1:0,style:{"margin-bottom":"15px"}},{default:a(()=>[t(J,{"body-style":{padding:"10px"}},{header:a(()=>[f("div",ke,[f("span",null,pe(l.projectName),1)])]),default:a(()=>[f("div",{style:{display:"flex","align-items":"center","justify-content":"center"},title:"\u70B9\u51FB\u9884\u89C8",onClick:N=>A(l)},[f("img",{src:l.thumbnail,class:"image"},null,8,we)],8,xe),f("div",Ce,[t(C,{type:"primary",onClick:N=>Q(l),style:{"margin-right":"8px"}},{default:a(()=>[_("\u8BBE\u8BA1")]),_:2},1032,["onClick"]),t(C,{type:"success",onClick:N=>M(l),style:{"margin-right":"8px"}},{default:a(()=>[_("\u4FEE\u6539")]),_:2},1032,["onClick"]),t(C,{type:"danger",onClick:N=>G(l)},{default:a(()=>[_("\u5220\u9664")]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1032,["offset"]))),128))]),_:1}),D(t(Y,{total:o(b),page:o(c).pageNum,"onUpdate:page":e[2]||(e[2]=l=>o(c).pageNum=l),limit:o(c).pageSize,"onUpdate:limit":e[3]||(e[3]=l=>o(c).pageSize=l),onPagination:m},null,8,["total","page","limit"]),[[F,o(b)>0]]),t(ee,{title:o(k),modelValue:o(i),"onUpdate:modelValue":e[7]||(e[7]=l=>I(i)?i.value=l:null),width:"500px","append-to-body":""},{footer:a(()=>[f("div",Ne,[t(y,{type:"primary",onClick:O},{default:a(()=>[_("\u786E \u5B9A")]),_:1}),t(y,{onClick:E},{default:a(()=>[_("\u53D6 \u6D88")]),_:1})])]),default:a(()=>[t($,{ref:"projectRef",model:o(s),rules:o(z),"label-width":"80px"},{default:a(()=>[t(d,{label:"\u9879\u76EE\u540D\u79F0",prop:"projectName"},{default:a(()=>[t(g,{modelValue:o(s).projectName,"onUpdate:modelValue":e[4]||(e[4]=l=>o(s).projectName=l),placeholder:"\u8BF7\u8F93\u5165\u9879\u76EE\u540D\u79F0"},null,8,["modelValue"])]),_:1}),t(d,{label:"\u5173\u8054\u8BBE\u5907"},{default:a(()=>[t(Z,{modelValue:o(v),"onUpdate:modelValue":e[5]||(e[5]=l=>I(v)?v.value=l:null),options:o(U),placeholder:"\u8BF7\u9009\u62E9\u5173\u8054\u8BBE\u5907",style:{width:"240px"},multiple:"",filterable:""},null,8,["modelValue","options"])]),_:1}),t(d,{label:"\u5907\u6CE8",prop:"remark"},{default:a(()=>[t(g,{modelValue:o(s).remark,"onUpdate:modelValue":e[6]||(e[6]=l=>o(s).remark=l),type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}}),$e=le(Ie,[["__scopeId","data-v-8dd3a2fd"]]);export{$e as default};
