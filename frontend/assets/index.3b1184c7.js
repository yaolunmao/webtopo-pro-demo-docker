import{_ as le,z as oe,u as ae,r as u,A as ne,L as se,a1 as re,d as s,o as V,c as q,C as L,D,f as o,e as t,w as a,i as ue,m as _,k as f,B as I,M as ce,N as de,j as ie,x as pe,s as me}from"./index.a653ca4b.js";import{l as _e,g as fe,u as ve,a as ge,d as ye}from"./project.1f00b2bb.js";import{b as he}from"./device.d0a509e0.js";const je={class:"app-container"},be={class:"toolbar"},ke={class:"card-header"},xe=["onClick"],we=["src"],Ce={style:{display:"flex","margin-top":"10px","justify-content":"flex-end"}},Ne={class:"dialog-footer"},Ve=oe({name:"Project"}),Ie=Object.assign(Ve,{setup(Se){const S=ae(),{proxy:p}=me(),P=u([]),i=u(!1),R=u(!0),h=u(!0),j=u([]);u(!0),u(!0);const b=u(0),k=u(""),U=u([]),v=u([]),z=ne({form:{},queryParams:{pageNum:1,pageSize:10,projectName:null},rules:{}}),{queryParams:c,form:r,rules:E}=se(z);function m(){R.value=!0,_e(c.value).then(n=>{P.value=n.rows,b.value=n.total,R.value=!1})}function F(){i.value=!1,x()}function x(){r.value={projectId:null,projectName:null,thumbnail:null,dataModel:null,createBy:null,createTime:null,updateBy:null,updateTime:null,remark:null},p.resetForm("projectRef"),v.value=[]}function w(){c.value.pageNum=1,m()}function T(){p.resetForm("queryRef"),w()}function A(){x(),i.value=!0,k.value="\u6DFB\u52A0\u9879\u76EE"}function K(n){const e=n.projectId||j.value;S.push({name:"WebtopoEdit",query:{project_id:e}})}function M(n){const e=n.projectId||j.value;window.open(S.resolve({path:"/webtopoPreview",query:{project_id:e}}).href)}function Q(n){console.log(n,175),x();const e=n.projectId||j.value;fe(e).then(g=>{r.value=g.data,v.value=g.data.deviceList.filter(d=>d.projectId==n.projectId).map(d=>d.deviceId),i.value=!0,k.value="\u4FEE\u6539\u9879\u76EE"})}function O(){p.$refs.projectRef.validate(n=>{n&&(r.value.deviceList=v.value.map(e=>({projectId:r.value.projectId,deviceId:e})),r.value.projectId!=null?ve(r.value).then(e=>{p.$modal.msgSuccess("\u4FEE\u6539\u6210\u529F"),i.value=!1,m()}):ge(r.value).then(e=>{p.$modal.msgSuccess("\u65B0\u589E\u6210\u529F"),i.value=!1,m()}))})}function W(n){const e=n.projectId||j.value;p.$modal.confirm('\u662F\u5426\u786E\u8BA4\u5220\u9664"'+n.projectName+'"\u7684\u6570\u636E\u9879\uFF1F').then(function(){return ye(e)}).then(()=>{m(),p.$modal.msgSuccess("\u5220\u9664\u6210\u529F")}).catch(()=>{})}return m(),he().then(n=>{if(console.log(n,224),n.code!=200){re.error(n.msg);return}U.value=n.rows.map(e=>({...e,label:e.name,value:e.id}))}),(n,e)=>{const g=s("el-input"),d=s("el-form-item"),y=s("el-button"),$=s("el-form"),G=s("el-tooltip"),H=s("right-toolbar"),B=s("el-row"),C=s("el-link"),J=s("el-card"),X=s("el-col"),Y=s("pagination"),Z=s("el-select-v2"),ee=s("el-dialog");return V(),q("div",je,[L(t($,{model:o(c),ref:"queryRef",inline:!0,"label-width":"68px"},{default:a(()=>[t(d,{label:"\u9879\u76EE\u540D\u79F0",prop:"projectName"},{default:a(()=>[t(g,{modelValue:o(c).projectName,"onUpdate:modelValue":e[0]||(e[0]=l=>o(c).projectName=l),placeholder:"\u8BF7\u8F93\u5165\u9879\u76EE\u540D\u79F0",clearable:"",onKeyup:ue(w,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),t(d,null,{default:a(()=>[t(y,{type:"primary",icon:"Search",onClick:w},{default:a(()=>[_("\u641C\u7D22")]),_:1}),t(y,{icon:"Refresh",onClick:T},{default:a(()=>[_("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1},8,["model"]),[[D,o(h)]]),t(B,{gutter:10,class:"mb8"},{default:a(()=>[f("div",be,[t(G,{effect:"dark",content:"\u65B0\u589E",placement:"top"},{default:a(()=>[t(y,{plain:"",circle:"",icon:"Plus",onClick:A,style:{"margin-right":"10px"}})]),_:1}),t(H,{showSearch:o(h),"onUpdate:showSearch":e[1]||(e[1]=l=>I(h)?h.value=l:null),onQueryTable:m},null,8,["showSearch"])])]),_:1}),t(B,null,{default:a(()=>[(V(!0),q(ce,null,de(o(P),(l,te)=>(V(),ie(X,{key:l.projectId,span:4,offset:te%5!==0?1:0,style:{"margin-bottom":"15px"}},{default:a(()=>[t(J,{"body-style":{padding:"10px"}},{header:a(()=>[f("div",ke,[f("span",null,pe(l.projectName),1)])]),default:a(()=>[f("div",{style:{display:"flex","align-items":"center","justify-content":"center"},title:"\u70B9\u51FB\u9884\u89C8",onClick:N=>M(l)},[f("img",{src:l.thumbnail,class:"image"},null,8,we)],8,xe),f("div",Ce,[t(C,{type:"primary",onClick:N=>K(l),style:{"margin-right":"8px"}},{default:a(()=>[_("\u8BBE\u8BA1")]),_:2},1032,["onClick"]),t(C,{type:"success",onClick:N=>Q(l),style:{"margin-right":"8px"}},{default:a(()=>[_("\u4FEE\u6539")]),_:2},1032,["onClick"]),t(C,{type:"danger",onClick:N=>W(l)},{default:a(()=>[_("\u5220\u9664")]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1032,["offset"]))),128))]),_:1}),L(t(Y,{total:o(b),page:o(c).pageNum,"onUpdate:page":e[2]||(e[2]=l=>o(c).pageNum=l),limit:o(c).pageSize,"onUpdate:limit":e[3]||(e[3]=l=>o(c).pageSize=l),onPagination:m},null,8,["total","page","limit"]),[[D,o(b)>0]]),t(ee,{title:o(k),modelValue:o(i),"onUpdate:modelValue":e[7]||(e[7]=l=>I(i)?i.value=l:null),width:"500px","append-to-body":""},{footer:a(()=>[f("div",Ne,[t(y,{type:"primary",onClick:O},{default:a(()=>[_("\u786E \u5B9A")]),_:1}),t(y,{onClick:F},{default:a(()=>[_("\u53D6 \u6D88")]),_:1})])]),default:a(()=>[t($,{ref:"projectRef",model:o(r),rules:o(E),"label-width":"80px"},{default:a(()=>[t(d,{label:"\u9879\u76EE\u540D\u79F0",prop:"projectName"},{default:a(()=>[t(g,{modelValue:o(r).projectName,"onUpdate:modelValue":e[4]||(e[4]=l=>o(r).projectName=l),placeholder:"\u8BF7\u8F93\u5165\u9879\u76EE\u540D\u79F0"},null,8,["modelValue"])]),_:1}),t(d,{label:"\u5173\u8054\u8BBE\u5907"},{default:a(()=>[t(Z,{modelValue:o(v),"onUpdate:modelValue":e[5]||(e[5]=l=>I(v)?v.value=l:null),options:o(U),placeholder:"\u8BF7\u9009\u62E9\u5173\u8054\u8BBE\u5907",style:{width:"240px"},multiple:"",filterable:""},null,8,["modelValue","options"])]),_:1}),t(d,{label:"\u5907\u6CE8",prop:"remark"},{default:a(()=>[t(g,{modelValue:o(r).remark,"onUpdate:modelValue":e[6]||(e[6]=l=>o(r).remark=l),type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}}),$e=le(Ie,[["__scopeId","data-v-8dd3a2fd"]]);export{$e as default};
